(function(e){function t(t){for(var s,i,o=t[0],c=t[1],u=t[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(s=!1)}s&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},a={app:0},r=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/bot/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"018c":function(e,t,n){},1959:function(e,t,n){e.exports=n.p+"img/send.ecefb1c9.png"},"362d":function(e,t,n){"use strict";var s=n("3c15"),a=n.n(s);a.a},"3c15":function(e,t,n){},"4b51":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"},on:{click:e.handleClick}},[n("Message"),n("InputArea")],1)},r=[],i=n("2f62"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"messages"},e._l(e.messages,(function(t,s){return n("div",{key:s},["bot"===t.type?n("MessageBot",{attrs:{message:t}}):e._e(),"user"===t.type?n("MessageUser",{attrs:{message:t}}):e._e(),"botMusic"===t.type?n("MessageBotMusic",{attrs:{message:t}}):e._e()],1)})),0)},c=[],u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-item"},[s("img",{staticClass:"avatar",attrs:{src:n("9ded"),alt:""}}),s("div",{staticClass:"content"},[e._v(" "+e._s(e.message.content)+" ")])])},l=[],d={props:{message:Object}},p=d,f=(n("fa64"),n("2877")),m=Object(f["a"])(p,u,l,!1,null,"8acdce5c",null),g=m.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message-item"},[n("div",{staticClass:"content"},[e._v(" "+e._s(e.message.content)+" ")])])},v=[],y={props:{message:Object}},b=y,w=(n("d200"),Object(f["a"])(b,h,v,!1,null,"538d902e",null)),_=w.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{},[s("div",{staticClass:"message-item"},[s("img",{staticClass:"avatar",attrs:{src:n("9ded"),alt:""}}),s("div",{staticClass:"content"},[e._v(" "+e._s(e.message.content)+" ")])]),s("div",{staticClass:"message-item-music"},[s("div",{staticClass:"top"},[s("img",{staticClass:"cover",attrs:{src:e.message.music.pic_url,alt:""}}),s("div",{staticClass:"name"},[s("div",{staticClass:"singer-name"},[e._v(e._s(e.message.music.singer_name))]),s("div",{staticClass:"song-name"},[e._v(e._s(e.message.music.song_name))])])]),s("div",{staticClass:"bottom"},[s("i",{staticClass:"iconfont",class:[e.isPlay?"icon-pause":"icon-play"],on:{click:e.handleControl}}),s("span",{staticClass:"time current"},[e._v(e._s(e._f("timeFormat")(e.currentTime)))]),s("div",{staticClass:"progress"},[s("div",{staticClass:"indicator",style:{left:e.progress+"%"}}),s("div",{staticClass:"front",style:{width:e.progress+"%"}})]),s("span",{staticClass:"time duration"},[e._v(e._s(e._f("timeFormat")(e.duration)))]),s("audio",{ref:"audio",attrs:{autoplay:""}},[s("source",{attrs:{src:e.message.music.music_url,type:"audio/ogg"}}),s("source",{attrs:{src:e.message.music.music_url,type:"audio/mpeg"}})])])])])},C=[],O={props:{message:Object},filters:{timeFormat:function(e){var t=Math.ceil(e),n=Math.floor(t/60),s=t-60*n;return n=n<10?"0".concat(n):String(n),s=s<10?"0".concat(s):String(s),n+":"+s}},data:function(){return{audio:"",duration:0,currentTime:0,playInterval:"",isPlay:!0}},computed:{progress:function(){return 100*this.currentTime/this.duration}},mounted:function(){var e=this;this.audio=this.$refs.audio;var t=setInterval((function(){4===e.audio.readyState&&(e.duration=e.audio.duration,e.startPlay(),clearInterval(t))}),100)},methods:{handleControl:function(){this.isPlay?(this.audio.pause(),clearInterval(this.playInterval)):this.startPlay(),this.isPlay=!this.isPlay},startPlay:function(){var e=this;this.currentTime===this.duration&&(this.audio.currentTime=0),this.audio.play(),this.playInterval=setInterval((function(){e.currentTime=e.audio.currentTime,e.currentTime===e.duration&&(clearInterval(e.playInterval),e.isPlay=!1)}),1e3)}}},j=O,M=(n("f4d6"),Object(f["a"])(j,x,C,!1,null,"564ec50f",null)),I=M.exports,P={computed:Object(i["b"])(["messages"]),components:{MessageBot:g,MessageUser:_,MessageBotMusic:I}},S=P,k=(n("e250"),Object(f["a"])(S,o,c,!1,null,"5edf09a0",null)),T=k.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"inputarea",staticClass:"inputarea"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.question,expression:"question"}],staticClass:"input",attrs:{type:"text"},domProps:{value:e.question},on:{focus:e.handleFocus,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleSend(t))},input:function(t){t.target.composing||(e.question=t.target.value)}}}),n("img",{staticClass:"send",attrs:{src:e.sendImage,alt:""},on:{click:e.handleSend}})])},$=[],R=(n("498a"),n("96cf"),n("1da1"));function E(e){return B.apply(this,arguments)}function B(){return B=Object(R["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].axios.get("/api/bot/query",{params:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),B.apply(this,arguments)}var F={data:function(){return{question:""}},computed:Object(i["b"])({systemInfo:"systemInfo",sendImage:function(){return this.question.trim()?n("7bec"):n("1959")}}),methods:{handleFocus:function(){return Object(R["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:setTimeout((function(){document.querySelector(".inputarea").scrollIntoView(!0)}),200);case 1:case"end":return e.stop()}}),e)})))()},handleSend:function(){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.question.trim(),n){t.next=3;break}return t.abrupt("return");case 3:return window.innerHeight<e.systemInfo.innerHeight&&document.querySelector(".input").focus(),e.question="",e.$store.dispatch("pushMessage",{type:"user",content:n}),t.next=8,E({msg:n});case 8:s=t.sent,200===s.status&&("music"===s.data.answer_type?e.$store.dispatch("pushMessage",{type:"botMusic",content:s.data.answer,music:s.data.msg[0]}):"text"===s.data.answer_type&&e.$store.dispatch("pushMessage",{type:"bot",content:s.data.answer}));case 10:case"end":return t.stop()}}),t)})))()}}},H=F,A=(n("362d"),Object(f["a"])(H,q,$,!1,null,"383fb5e6",null)),U=A.exports;n("d3b7");function J(e){return new Promise((function(t){return setTimeout(t,e)}))}function X(){return 375===screen.width&&812===screen.height||414===screen.width&&896===screen.height}function D(){var e=window.navigator.userAgent,t=/iphone.+mobile.+safari/i.test(e);return t}function L(){return N.apply(this,arguments)}function N(){return N=Object(R["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,J(200);case 2:t=document.querySelector(".messages").clientHeight,"function"===typeof document.body.scrollTo?window.scrollTo({top:t,behavior:"smooth"}):window.scrollTop=t;case 4:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}var V={components:{Message:T,InputArea:U},computed:Object(i["b"])(["systemInfo"]),created:function(){var e={innerHeight:window.innerHeight,iPhoneX:X(),safari:D()};this.$store.commit("initSystemInfo",e),this.$store.dispatch("pushMessage",{type:"bot",content:"我是可盐可甜的然然，我什么都知道，不信你可以问我世界首富是谁，还可以听一首追光者"})},mounted:function(){this.systemInfo.iPhoneX&&!this.systemInfo.safari&&(document.querySelector(".inputarea").style.height="90px",document.querySelector(".message").style.marginBottom="90px")},methods:{handleClick:function(){document.querySelector(".inputarea").blur()}}},z=V,G=(n("ffc4"),Object(f["a"])(z,a,r,!1,null,"202a3a3c",null)),K=G.exports,Q=n("bc3a"),W=n.n(Q),Y=n("a7fe"),Z=n.n(Y);n("99af");s["a"].use(i["a"]);var ee=new i["a"].Store({state:{systemInfo:{},messages:[]},mutations:{initSystemInfo:function(e,t){e.systemInfo=t},pushMessage:function(e,t){e.messages=e.messages.concat(t)}},actions:{pushMessage:function(e,t){var n=e.commit;n("pushMessage",t),L()}},modules:{}});n("4b51");W.a.defaults.baseURL="http://www.yinmengran.cn:8026/",s["a"].use(Z.a,W.a),s["a"].config.productionTip=!1,new s["a"]({store:ee,render:function(e){return e(K)}}).$mount("#app")},"7bec":function(e,t,n){e.exports=n.p+"img/send-active.01fe4a22.png"},9153:function(e,t,n){},"9ded":function(e,t,n){e.exports=n.p+"img/bot.6e6e1e15.png"},b9d3:function(e,t,n){},c9af:function(e,t,n){},d200:function(e,t,n){"use strict";var s=n("9153"),a=n.n(s);a.a},d4f1:function(e,t,n){},e250:function(e,t,n){"use strict";var s=n("c9af"),a=n.n(s);a.a},f4d6:function(e,t,n){"use strict";var s=n("d4f1"),a=n.n(s);a.a},fa64:function(e,t,n){"use strict";var s=n("018c"),a=n.n(s);a.a},ffc4:function(e,t,n){"use strict";var s=n("b9d3"),a=n.n(s);a.a}});